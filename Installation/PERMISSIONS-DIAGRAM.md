# RBAC System - Visuelle Diagramme

Visuelle Darstellung der Beziehungen und Strukturen im RBAC-System.

## ğŸ“Š Datenbank-Struktur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USERS       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ email           â”‚
â”‚ first_name      â”‚
â”‚ last_name       â”‚
â”‚ is_admin        â”‚â—„â”€â”€â”€â”€â”€ Legacy KompatibilitÃ¤t
â”‚ is_member       â”‚
â”‚ is_active       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ n:m
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER_ROLES    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ user_id (FK)    â”‚
â”‚ role_id (FK)    â”‚
â”‚ assigned_at     â”‚
â”‚ assigned_by     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ n:1
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ROLES       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ name            â”‚
â”‚ display_name    â”‚
â”‚ description     â”‚
â”‚ priority        â”‚
â”‚ upload_limit_mb â”‚
â”‚ is_system_role  â”‚
â”‚ color           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ n:m
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ROLE_PERMISSIONS â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ role_id (FK)     â”‚
â”‚ permission_id    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ n:1
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PERMISSIONS    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ name            â”‚
â”‚ display_name    â”‚
â”‚ description     â”‚
â”‚ category        â”‚
â”‚ is_system_perm  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Authentifizierungs-Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Login      â”‚
â”‚   Request    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Credentials prÃ¼fen   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User-Daten aus DB laden          â”‚
â”‚ - Basis-Info                     â”‚
â”‚ - Rollen (via user_roles)        â”‚
â”‚ - Berechtigungen (via            â”‚
â”‚   role_permissions)              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Auto-Migration (falls nÃ¶tig)     â”‚
â”‚ is_admin=true  â†’ webmaster       â”‚
â”‚ is_member=true â†’ mitglied        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JWT erstellen mit:               â”‚
â”‚ - User-ID                        â”‚
â”‚ - Rollen-Array                   â”‚
â”‚ - Berechtigungs-Array            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Access Token +       â”‚
â”‚ Refresh Token        â”‚
â”‚ an Client senden     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›¡ï¸ Request-Autorisierung

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Request     â”‚
â”‚  + JWT Token     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ authenticate Middleware â”‚
â”‚ - Token validieren      â”‚
â”‚ - User-Objekt erstellen â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ requirePermission Middleware     â”‚
â”‚                                  â”‚
â”‚ IF user.is_admin â†’ âœ“ Allow      â”‚
â”‚ ELSE IF permission in            â”‚
â”‚    user.permissions â†’ âœ“ Allow   â”‚
â”‚ ELSE â†’ âœ— Deny (403)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Route Handler    â”‚
â”‚ (Business Logic) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Response       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘¥ Rollen-Hierarchie

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   WEBMASTER   â”‚
                    â”‚               â”‚
                    â”‚ Priority: 100 â”‚
                    â”‚ Upload: 50MB  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   VORSTAND     â”‚             â”‚  KASSENWART    â”‚
    â”‚                â”‚             â”‚                â”‚
    â”‚ Priority: 50   â”‚             â”‚ Priority: 20   â”‚
    â”‚ Upload: 30MB   â”‚             â”‚ Upload: 30MB   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                               â”‚
            â”‚                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚                                â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FLUGLEHRER    â”‚          â”‚  JUGENDWART    â”‚
â”‚                â”‚          â”‚                â”‚
â”‚ Priority: 15   â”‚          â”‚ Priority: 10   â”‚
â”‚ Upload: 10MB   â”‚          â”‚ Upload: 10MB   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   MITGLIED     â”‚
           â”‚                â”‚
           â”‚ Priority: 5    â”‚
           â”‚ Upload: 5MB    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Hinweis:** HÃ¶here Priority = Mehr Rechte  
Bei mehreren Rollen wird die hÃ¶chste Priority verwendet.

---

## ğŸ—‚ï¸ Berechtigungs-Kategorien

```
PERMISSIONS
â”œâ”€â”€ ğŸ“° ARTICLES (12)
â”‚   â”œâ”€â”€ view
â”‚   â”œâ”€â”€ create
â”‚   â”œâ”€â”€ edit.own
â”‚   â”œâ”€â”€ edit.all
â”‚   â”œâ”€â”€ delete
â”‚   â”œâ”€â”€ publish
â”‚   â””â”€â”€ ... (6 erweiterte)
â”‚
â”œâ”€â”€ ğŸ‘¥ MEMBERS (15)
â”‚   â”œâ”€â”€ view
â”‚   â”œâ”€â”€ view.details
â”‚   â”œâ”€â”€ edit
â”‚   â”œâ”€â”€ delete
â”‚   â”œâ”€â”€ roles.manage
â”‚   â””â”€â”€ ... (10 erweiterte)
â”‚
â”œâ”€â”€ âœˆï¸ FLUGBUCH (13)
â”‚   â”œâ”€â”€ view
â”‚   â”œâ”€â”€ create
â”‚   â”œâ”€â”€ edit.own
â”‚   â”œâ”€â”€ edit.all
â”‚   â”œâ”€â”€ delete
â”‚   â”œâ”€â”€ export
â”‚   â””â”€â”€ ... (7 erweiterte)
â”‚
â”œâ”€â”€ ğŸ“… EVENTS (10)
â”‚   â”œâ”€â”€ view
â”‚   â”œâ”€â”€ create
â”‚   â”œâ”€â”€ edit
â”‚   â”œâ”€â”€ delete
â”‚   â””â”€â”€ ... (6 erweiterte)
â”‚
â”œâ”€â”€ ğŸ–¼ï¸ IMAGES (11)
â”‚   â”œâ”€â”€ view
â”‚   â”œâ”€â”€ upload
â”‚   â”œâ”€â”€ delete.own
â”‚   â”œâ”€â”€ delete.all
â”‚   â”œâ”€â”€ galleries.manage
â”‚   â””â”€â”€ ... (6 erweiterte)
â”‚
â”œâ”€â”€ ğŸ“„ DOCUMENTS (11)
â”‚   â”œâ”€â”€ view
â”‚   â”œâ”€â”€ upload
â”‚   â”œâ”€â”€ delete
â”‚   â”œâ”€â”€ protocols.view
â”‚   â”œâ”€â”€ protocols.create
â”‚   â”œâ”€â”€ protocols.edit
â”‚   â””â”€â”€ ... (5 erweiterte)
â”‚
â”œâ”€â”€ ğŸ”” NOTIFICATIONS (9)
â”‚   â”œâ”€â”€ send.own
â”‚   â”œâ”€â”€ send.all
â”‚   â””â”€â”€ ... (7 erweiterte)
â”‚
â”œâ”€â”€ âš™ï¸ SYSTEM (16)
â”‚   â”œâ”€â”€ settings
â”‚   â”œâ”€â”€ database
â”‚   â”œâ”€â”€ audit.view
â”‚   â”œâ”€â”€ roles.manage
â”‚   â””â”€â”€ ... (12 erweiterte)
â”‚
â”œâ”€â”€ ğŸ›ï¸ CLUB (8)
â”œâ”€â”€ ğŸ’° FINANCE (12)
â”œâ”€â”€ ğŸ“ TRAINING (12)
â”œâ”€â”€ ğŸ“¦ INVENTORY (10)
â”œâ”€â”€ ğŸ“Š STATISTICS (6)
â””â”€â”€ ğŸ–¥ï¸ KIOSK (7)

Gesamt: 140+ Berechtigungen
```

---

## ğŸ” Scope-Hierarchie

```
PERMISSION SCOPES

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         .view                   â”‚  â† Nur ansehen
â”‚    (Niedrigste Stufe)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        .create                  â”‚  â† Neu erstellen
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       .edit.own                 â”‚  â† Eigene bearbeiten
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       .edit.all                 â”‚  â† Alle bearbeiten
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        .delete                  â”‚  â† LÃ¶schen
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        .manage                  â”‚  â† VollstÃ¤ndige Verwaltung
â”‚    (HÃ¶chste Stufe)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Beispiel: ARTICLES

articles.view           â”€â”
                         â”‚
articles.create         â”€â”¤
                         â”œâ”€â–º Mitglied kann:
                         â”‚   - Ansehen
articles.edit.own       â”€â”˜   - Eigene bearbeiten

articles.edit.all       â”€â”
                         â”œâ”€â–º Vorstand kann zusÃ¤tzlich:
articles.publish        â”€â”¤   - Alle bearbeiten
                         â”‚   - VerÃ¶ffentlichen
                         â”‚
articles.delete         â”€â”˜â”€â–º Webmaster kann zusÃ¤tzlich:
                             - LÃ¶schen
```

---

## ğŸ”„ Frontend Permission Check Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React Component      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ usePermissions()
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PermissionsContext   â”‚
â”‚                       â”‚
â”‚ - user.permissions    â”‚
â”‚ - hasPermission()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  hasPermission('articles.edit')  â”‚
â”‚                                  â”‚
â”‚  IF user === null                â”‚
â”‚    â†’ return false                â”‚
â”‚                                  â”‚
â”‚  IF user.is_admin === true       â”‚
â”‚    â†’ return true (Legacy)        â”‚
â”‚                                  â”‚
â”‚  IF permission in                â”‚
â”‚     user.permissions             â”‚
â”‚    â†’ return true                 â”‚
â”‚                                  â”‚
â”‚  ELSE                            â”‚
â”‚    â†’ return false                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Conditional Render  â”‚
â”‚                      â”‚
â”‚  true  â†’ Show        â”‚
â”‚  false â†’ Hide        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ UI Rollen-Verwaltung

```
/verwaltung#rollen

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ROLLEN ÃœBERSICHT                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Rolle   â”‚ Benutzer â”‚ Rechte    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Webm... â”‚    1     â”‚    140+   â”‚â—„â”€â”€â”¼â”€â”€ Klick â†’ Details
â”‚  â”‚ Vorst...â”‚    5     â”‚     60    â”‚   â”‚
â”‚  â”‚ Mitgl...â”‚   75     â”‚     20    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  [+ Neue Rolle]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ Rolle bearbeiten
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ROLLE BEARBEITEN: Vorstand         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Name:        [Vorstand        ]        â”‚
â”‚  Anzeigename: [Vorstand        ]        â”‚
â”‚  Upload Limit:[30 MB           ]        â”‚
â”‚  PrioritÃ¤t:   [50              ]        â”‚
â”‚  Farbe:       [ğŸŸ¦ #3B82F6      ]        â”‚
â”‚                                         â”‚
â”‚  BERECHTIGUNGEN:                        â”‚
â”‚  â”Œâ”€ Artikel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ â˜‘ Artikel ansehen             â”‚      â”‚
â”‚  â”‚ â˜‘ Artikel erstellen           â”‚      â”‚
â”‚  â”‚ â˜‘ Eigene Artikel bearbeiten   â”‚      â”‚
â”‚  â”‚ â˜‘ Artikel verÃ¶ffentlichen     â”‚      â”‚
â”‚  â”‚ â˜ Alle Artikel bearbeiten     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€ Mitglieder â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ â˜‘ Mitglieder ansehen          â”‚      â”‚
â”‚  â”‚ â˜‘ Mitgliederdetails ansehen   â”‚      â”‚
â”‚  â”‚ â˜‘ Mitglieder bearbeiten       â”‚      â”‚
â”‚  â”‚ â˜ Mitglieder lÃ¶schen          â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                         â”‚
â”‚  [Speichern]  [Abbrechen]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ºï¸ Berechtigungs-Matrix

```
                    â”‚ Mit- â”‚ Vor- â”‚ Web- â”‚ Kassen- â”‚ Flug- â”‚
                    â”‚glied â”‚stand â”‚masterâ”‚  wart   â”‚lehrer â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
articles.view       â”‚  âœ“   â”‚  âœ“   â”‚  âœ“   â”‚    âœ“    â”‚   âœ“   â”‚
articles.create     â”‚      â”‚  âœ“   â”‚  âœ“   â”‚         â”‚       â”‚
articles.publish    â”‚      â”‚  âœ“   â”‚  âœ“   â”‚         â”‚       â”‚
articles.delete     â”‚      â”‚      â”‚  âœ“   â”‚         â”‚       â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
members.view        â”‚  âœ“   â”‚  âœ“   â”‚  âœ“   â”‚    âœ“    â”‚   âœ“   â”‚
members.view.detailsâ”‚      â”‚  âœ“   â”‚  âœ“   â”‚    âœ“    â”‚       â”‚
members.edit        â”‚      â”‚  âœ“   â”‚  âœ“   â”‚         â”‚       â”‚
members.delete      â”‚      â”‚      â”‚  âœ“   â”‚         â”‚       â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
flugbuch.view       â”‚  âœ“   â”‚  âœ“   â”‚  âœ“   â”‚    âœ“    â”‚   âœ“   â”‚
flugbuch.create     â”‚  âœ“   â”‚  âœ“   â”‚  âœ“   â”‚    âœ“    â”‚   âœ“   â”‚
flugbuch.edit.own   â”‚  âœ“   â”‚  âœ“   â”‚  âœ“   â”‚    âœ“    â”‚   âœ“   â”‚
flugbuch.edit.all   â”‚      â”‚  âœ“   â”‚  âœ“   â”‚         â”‚   âœ“   â”‚
flugbuch.export     â”‚      â”‚  âœ“   â”‚  âœ“   â”‚         â”‚   âœ“   â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
finance.view        â”‚      â”‚      â”‚  âœ“   â”‚    âœ“    â”‚       â”‚
finance.*.all       â”‚      â”‚      â”‚  âœ“   â”‚    âœ“    â”‚       â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
training.*          â”‚      â”‚      â”‚  âœ“   â”‚         â”‚   âœ“   â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
system.settings     â”‚      â”‚      â”‚  âœ“   â”‚         â”‚       â”‚
system.database     â”‚      â”‚      â”‚  âœ“   â”‚         â”‚       â”‚
system.roles.manage â”‚      â”‚      â”‚  âœ“   â”‚         â”‚       â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

Legende:
âœ“ = Berechtigung vorhanden
  = Keine Berechtigung
```

---

## ğŸ”„ Migrations-Flow

```
LEGACY SYSTEM                 RBAC SYSTEM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User mit is_admin=true
        â”‚
        â”‚ Bei Login
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PrÃ¼fe ob Rollen    â”‚
â”‚ vorhanden          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Keine Rollen?
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Suche 'webmaster'  â”‚
â”‚ Rolle              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INSERT INTO        â”‚
â”‚ user_roles         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lade alle          â”‚
â”‚ Berechtigungen     â”‚
â”‚ der Rolle          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    JWT mit:
    - roles: ['webmaster']
    - permissions: [140+ Berechtigungen]
    - is_admin: true (Legacy)


WICHTIG:
is_admin=true bleibt erhalten!
â†’ Immer alle Berechtigungen
â†’ Fallback fÃ¼r KompatibilitÃ¤t
```

---

## ğŸ“¡ API-Struktur

```
/api
â”œâ”€â”€ /auth
â”‚   â”œâ”€â”€ POST /login          â†’ JWT mit permissions
â”‚   â”œâ”€â”€ POST /register       
â”‚   â””â”€â”€ POST /refresh        â†’ Neuer JWT
â”‚
â”œâ”€â”€ /roles                   (requirePermission: system.roles.manage)
â”‚   â”œâ”€â”€ GET  /               â†’ Alle Rollen
â”‚   â”œâ”€â”€ GET  /:id            â†’ Eine Rolle mit permissions
â”‚   â”œâ”€â”€ POST /               â†’ Neue Rolle
â”‚   â”œâ”€â”€ PUT  /:id            â†’ Rolle bearbeiten
â”‚   â””â”€â”€ DELETE /:id          â†’ Rolle lÃ¶schen
â”‚
â”œâ”€â”€ /permissions             (requirePermission: system.roles.manage)
â”‚   â”œâ”€â”€ GET  /               â†’ Alle Berechtigungen
â”‚   â””â”€â”€ GET  /categories     â†’ Berechtigungen nach Kategorie
â”‚
â”œâ”€â”€ /users
â”‚   â”œâ”€â”€ GET  /               (requirePermission: members.view)
â”‚   â”œâ”€â”€ GET  /:id            (requirePermission: members.view.details)
â”‚   â”œâ”€â”€ PUT  /:id            (requirePermission: members.edit)
â”‚   â””â”€â”€ PUT  /:id/roles      (requirePermission: members.roles.manage)
â”‚
â””â”€â”€ ...weitere Routen mit jeweiliger Berechtigung
```

---

## ğŸ¯ Zusammenfassung

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          RBAC SYSTEM OVERVIEW                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  140+ Berechtigungen                         â”‚
â”‚    â”œâ”€ 40 Kern-Berechtigungen                â”‚
â”‚    â””â”€ 100+ Erweiterte Berechtigungen         â”‚
â”‚                                              â”‚
â”‚  14 Kategorien                               â”‚
â”‚    â”œâ”€ Artikel, Mitglieder, Flugbuch         â”‚
â”‚    â”œâ”€ Events, Bilder, Dokumente             â”‚
â”‚    â”œâ”€ Benachrichtigungen, System            â”‚
â”‚    â””â”€ Club, Finance, Training, ...          â”‚
â”‚                                              â”‚
â”‚  6 Standard-Rollen                           â”‚
â”‚    â”œâ”€ Mitglied      (Priority:   5)         â”‚
â”‚    â”œâ”€ Jugendwart    (Priority:  10)         â”‚
â”‚    â”œâ”€ Fluglehrer    (Priority:  15)         â”‚
â”‚    â”œâ”€ Kassenwart    (Priority:  20)         â”‚
â”‚    â”œâ”€ Vorstand      (Priority:  50)         â”‚
â”‚    â””â”€ Webmaster     (Priority: 100)         â”‚
â”‚                                              â”‚
â”‚  âˆ Custom-Rollen                            â”‚
â”‚    â””â”€ Ãœber UI erstellbar                    â”‚
â”‚                                              â”‚
â”‚  VollstÃ¤ndig administrierbar                 â”‚
â”‚    â””â”€ /verwaltung#rollen                    â”‚
â”‚                                              â”‚
â”‚  Legacy-Kompatibel                           â”‚
â”‚    â””â”€ is_admin=true â†’ Alle Rechte          â”‚
â”‚                                              â”‚
â”‚  Audit-Logging                               â”‚
â”‚    â””â”€ Alle Zugriffe protokolliert           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Letzte Aktualisierung:** 2025-10-31  
**Version:** 1.0.0
